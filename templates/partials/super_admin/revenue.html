<!-- Revenue Analytics Section -->
<!-- Answers: What's the detailed revenue breakdown? Trends? -->

<!-- Revenue Overview -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="metric-card highlight">
        <div class="flex items-start justify-between">
            <div>
                <p class="metric-label">Annual Recurring Revenue</p>
                <p class="metric-value">₦{{ "{:,.0f}".format(dashboard.platform_revenue.arr if dashboard.platform_revenue else 0) }}</p>
                <div class="metric-trend up mt-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>
                    <span>+15.2% YoY Growth</span>
                </div>
            </div>
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            </div>
        </div>
    </div>
    <div class="metric-card">
        <p class="metric-label">Monthly Recurring Revenue</p>
        <p class="metric-value text-ng-green">₦{{ "{:,.0f}".format(dashboard.platform_revenue.mrr if dashboard.platform_revenue else 0) }}</p>
        <p class="text-sm text-gray-500 mt-2">{{ dashboard.platform_revenue.growth_rate if dashboard.platform_revenue else '+8.3%' }} from last month</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">Net Revenue Retention</p>
        <p class="metric-value text-ng-green">{{ dashboard.revenue_metrics.nrr if dashboard.revenue_metrics else '108%' }}</p>
        <p class="text-sm text-gray-500 mt-2">Above 100% = Expansion</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">Customer Lifetime Value</p>
        <p class="metric-value">₦{{ "{:,.0f}".format(dashboard.revenue_metrics.ltv if dashboard.revenue_metrics else 1250000) }}</p>
        <p class="text-sm text-gray-500 mt-2">LTV:CAC = 4.2:1</p>
    </div>
</div>

<!-- Revenue Breakdown -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <!-- By Tier -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"/></svg>
                Revenue by Tier
            </h3>
        </div>
        <div class="space-y-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-4 h-4 rounded-full bg-purple-500"></div>
                    <span class="text-sm">Enterprise</span>
                </div>
                <div class="text-right">
                    <p class="font-semibold">₦2,850,000</p>
                    <p class="text-xs text-gray-500">38%</p>
                </div>
            </div>
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-4 h-4 rounded-full bg-blue-500"></div>
                    <span class="text-sm">Professional</span>
                </div>
                <div class="text-right">
                    <p class="font-semibold">₦3,150,000</p>
                    <p class="text-xs text-gray-500">42%</p>
                </div>
            </div>
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-4 h-4 rounded-full bg-green-500"></div>
                    <span class="text-sm">Core</span>
                </div>
                <div class="text-right">
                    <p class="font-semibold">₦1,500,000</p>
                    <p class="text-xs text-gray-500">20%</p>
                </div>
            </div>
        </div>
        <div class="mt-4 pt-4 border-t border-gray-100">
            <div class="flex justify-between font-semibold">
                <span>Total MRR</span>
                <span class="text-ng-green">₦7,500,000</span>
            </div>
        </div>
    </div>
    
    <!-- Add-on Revenue -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
                Intelligence Add-on
            </h3>
        </div>
        <div class="text-center py-6">
            <p class="text-4xl font-bold text-purple-600">₦750,000</p>
            <p class="text-sm text-gray-500 mt-1">Monthly Add-on Revenue</p>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-500">Active subscriptions</span>
                <span class="font-medium">30</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-500">Attach rate</span>
                <span class="font-medium text-ng-green">24%</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-500">Price/month</span>
                <span class="font-medium">₦25,000</span>
            </div>
        </div>
    </div>
    
    <!-- MRR Movement -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>
                MRR Movement (This Month)
            </h3>
        </div>
        <div class="space-y-3">
            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                <div class="flex items-center gap-2">
                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/></svg>
                    <span class="text-sm">New MRR</span>
                </div>
                <span class="font-semibold text-green-600">+₦450,000</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                <div class="flex items-center gap-2">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/></svg>
                    <span class="text-sm">Expansion MRR</span>
                </div>
                <span class="font-semibold text-blue-600">+₦175,000</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-amber-50 rounded-lg">
                <div class="flex items-center gap-2">
                    <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/></svg>
                    <span class="text-sm">Contraction MRR</span>
                </div>
                <span class="font-semibold text-amber-600">-₦50,000</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                <div class="flex items-center gap-2">
                    <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"/></svg>
                    <span class="text-sm">Churned MRR</span>
                </div>
                <span class="font-semibold text-red-600">-₦30,000</span>
            </div>
        </div>
        <div class="mt-4 pt-4 border-t border-gray-100">
            <div class="flex justify-between font-semibold">
                <span>Net MRR Change</span>
                <span class="text-ng-green">+₦545,000</span>
            </div>
        </div>
    </div>
</div>

<!-- Revenue Table -->
<div class="data-grid">
    <div class="p-4 border-b border-gray-100">
        <div class="flex items-center justify-between">
            <h3 class="font-semibold text-gray-900 flex items-center gap-2">
                <svg class="w-5 h-5 text-ng-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                Top Revenue Contributing Tenants
            </h3>
            <button class="btn-secondary text-sm">Export Report</button>
        </div>
    </div>
    <table>
        <thead>
            <tr>
                <th>Tenant</th>
                <th>Tier</th>
                <th>MRR</th>
                <th>Intelligence</th>
                <th>Total Revenue</th>
                <th>Since</th>
                <th>LTV</th>
            </tr>
        </thead>
        <tbody>
            {% for org in dashboard.all_organizations[:8] if dashboard.all_organizations %}
            <tr>
                <td class="font-medium">{{ org.name }}</td>
                <td><span class="sku-badge {{ org.subscription_tier or 'core' }}">{{ (org.subscription_tier or 'core').title() }}</span></td>
                <td class="font-medium">₦{{ "{:,.0f}".format((150000 if org.subscription_tier == 'enterprise' else 50000 if org.subscription_tier == 'professional' else 15000)) }}</td>
                <td>
                    {% if loop.index % 4 == 1 %}
                    <span class="text-ng-green font-medium">+₦25,000</span>
                    {% else %}
                    <span class="text-gray-400">-</span>
                    {% endif %}
                </td>
                <td class="font-semibold text-ng-green">₦{{ "{:,.0f}".format((175000 if org.subscription_tier == 'enterprise' and loop.index % 4 == 1 else 150000 if org.subscription_tier == 'enterprise' else 75000 if org.subscription_tier == 'professional' and loop.index % 4 == 1 else 50000 if org.subscription_tier == 'professional' else 40000 if loop.index % 4 == 1 else 15000)) }}</td>
                <td class="text-sm text-gray-500">{{ org.created_at[:10] if org.created_at else 'Jan 2024' }}</td>
                <td class="font-medium">₦{{ "{:,.0f}".format((150000 if org.subscription_tier == 'enterprise' else 50000 if org.subscription_tier == 'professional' else 15000) * 12) }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" class="text-center py-8 text-gray-500">No revenue data available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
