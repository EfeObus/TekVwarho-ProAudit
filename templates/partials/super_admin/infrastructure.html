<!-- Infrastructure Section -->
<!-- Answers: How's the platform performing? Any issues? -->

<!-- System Health Overview -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="metric-card highlight">
        <div class="flex items-start justify-between">
            <div>
                <p class="metric-label">System Status</p>
                <p class="metric-value text-2xl">All Operational</p>
            </div>
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
            </div>
        </div>
    </div>
    <div class="metric-card">
        <p class="metric-label">Uptime (30d)</p>
        <p class="metric-value text-ng-green">{{ dashboard.platform_health.api.uptime if dashboard.platform_health else '99.97%' }}</p>
        <p class="text-sm text-gray-500 mt-2">SLA: 99.9%</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">Avg Response Time</p>
        <p class="metric-value">{{ dashboard.platform_health.api.response_time_ms if dashboard.platform_health else 45 }}ms</p>
        <p class="text-sm text-gray-500 mt-2">Target: < 100ms</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">Error Rate</p>
        <p class="metric-value text-ng-green">0.02%</p>
        <p class="text-sm text-gray-500 mt-2">Target: < 0.1%</p>
    </div>
</div>

<!-- Service Status Grid -->
<div class="mb-8">
    <div class="section-header mb-4">
        <h3 class="section-title">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"/></svg>
            Service Health Status
        </h3>
    </div>
    
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
        {% for service in [
            ('API Gateway', 'healthy', '45ms'),
            ('Database', 'healthy', '12ms'),
            ('Redis Cache', 'healthy', '2ms'),
            ('NRS Gateway', 'healthy', '89ms'),
            ('Paystack', 'healthy', '120ms'),
            ('ML Pipeline', 'healthy', '250ms'),
            ('Email Service', 'healthy', '95ms'),
            ('File Storage', 'healthy', '35ms'),
            ('Celery Workers', 'healthy', '4 active'),
            ('Scheduler', 'healthy', 'Running'),
            ('Backup Service', 'healthy', 'Last: 2h ago'),
            ('Monitoring', 'healthy', 'Active')
        ] %}
        <div class="p-4 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between mb-2">
                <span class="health-indicator {{ service[1] }}"></span>
                <span class="text-xs text-gray-400">{{ service[2] }}</span>
            </div>
            <p class="font-medium text-sm text-gray-900">{{ service[0] }}</p>
            <p class="text-xs text-gray-500 mt-1 capitalize">{{ service[1] }}</p>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Resource Usage -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Server Resources -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/></svg>
                Server Resources
            </h3>
        </div>
        <div class="space-y-4">
            <!-- CPU -->
            <div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-medium">CPU Usage</span>
                    <span class="text-gray-500">32% / 100%</span>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-ng-green rounded-full" style="width: 32%"></div>
                </div>
            </div>
            <!-- Memory -->
            <div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-medium">Memory Usage</span>
                    <span class="text-gray-500">4.2GB / 8GB</span>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-blue-500 rounded-full" style="width: 52%"></div>
                </div>
            </div>
            <!-- Disk -->
            <div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-medium">Disk Usage</span>
                    <span class="text-gray-500">156GB / 500GB</span>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-amber-500 rounded-full" style="width: 31%"></div>
                </div>
            </div>
            <!-- Network -->
            <div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-medium">Network I/O</span>
                    <span class="text-gray-500">245 Mbps in / 89 Mbps out</span>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 rounded-full" style="width: 24%"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Database Stats -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"/></svg>
                Database Statistics
            </h3>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div class="text-center p-4 bg-gray-50 rounded-xl">
                <p class="text-2xl font-bold text-ng-green">{{ dashboard.db_stats.connections if dashboard.db_stats else 45 }}</p>
                <p class="text-xs text-gray-500 mt-1">Active Connections</p>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded-xl">
                <p class="text-2xl font-bold">12ms</p>
                <p class="text-xs text-gray-500 mt-1">Avg Query Time</p>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded-xl">
                <p class="text-2xl font-bold">{{ dashboard.db_stats.total_records if dashboard.db_stats else '2.4M' }}</p>
                <p class="text-xs text-gray-500 mt-1">Total Records</p>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded-xl">
                <p class="text-2xl font-bold">156GB</p>
                <p class="text-xs text-gray-500 mt-1">Database Size</p>
            </div>
        </div>
        <div class="mt-4 pt-4 border-t border-gray-100">
            <div class="flex items-center justify-between text-sm">
                <span class="text-gray-500">Last Backup:</span>
                <span class="font-medium text-ng-green">2 hours ago</span>
            </div>
            <div class="flex items-center justify-between text-sm mt-2">
                <span class="text-gray-500">Backup Size:</span>
                <span class="font-medium">48GB</span>
            </div>
        </div>
    </div>
</div>

<!-- Queue Status -->
<div class="data-grid mb-8">
    <div class="p-4 border-b border-gray-100">
        <div class="flex items-center justify-between">
            <h3 class="font-semibold text-gray-900 flex items-center gap-2">
                <svg class="w-5 h-5 text-ng-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                Task Queue Status
            </h3>
            <div class="flex items-center gap-4">
                <span class="flex items-center gap-2 text-sm">
                    <span class="health-indicator healthy"></span>
                    <span>Workers: 4 active</span>
                </span>
            </div>
        </div>
    </div>
    <table>
        <thead>
            <tr>
                <th>Queue</th>
                <th>Pending</th>
                <th>Processing</th>
                <th>Completed (24h)</th>
                <th>Failed (24h)</th>
                <th>Avg Time</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for queue in [
                ('default', 12, 3, 1542, 2, '0.8s', 'healthy'),
                ('ml_jobs', 34, 4, 847, 3, '2.3s', 'healthy'),
                ('emails', 5, 1, 432, 0, '0.5s', 'healthy'),
                ('reports', 8, 2, 156, 1, '4.2s', 'healthy'),
                ('backups', 0, 1, 24, 0, '45s', 'healthy')
            ] %}
            <tr>
                <td class="font-mono text-sm">{{ queue[0] }}</td>
                <td>
                    <span class="{% if queue[1] > 50 %}text-amber-600 font-medium{% else %}text-gray-600{% endif %}">{{ queue[1] }}</span>
                </td>
                <td class="text-blue-600 font-medium">{{ queue[2] }}</td>
                <td class="text-ng-green font-medium">{{ queue[3] }}</td>
                <td class="{% if queue[4] > 0 %}text-red-500{% else %}text-gray-400{% endif %}">{{ queue[4] }}</td>
                <td class="text-gray-500">{{ queue[5] }}</td>
                <td>
                    <span class="flex items-center gap-2">
                        <span class="health-indicator {{ queue[6] }}"></span>
                        <span class="text-sm capitalize">{{ queue[6] }}</span>
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Recent Incidents -->
<div class="metric-card">
    <div class="section-header">
        <h3 class="section-title">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            Recent Incidents (30 days)
        </h3>
        <span class="text-sm text-gray-500">2 resolved</span>
    </div>
    <div class="space-y-3">
        <div class="flex items-start gap-4 p-3 bg-gray-50 rounded-lg">
            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            </div>
            <div class="flex-1">
                <div class="flex items-center justify-between">
                    <p class="font-medium text-gray-900">API Latency Spike</p>
                    <span class="status-badge active">Resolved</span>
                </div>
                <p class="text-sm text-gray-500 mt-1">Brief increase in response times due to database connection pool exhaustion</p>
                <p class="text-xs text-gray-400 mt-2">Jan 18, 2025 - Duration: 12 minutes</p>
            </div>
        </div>
        <div class="flex items-start gap-4 p-3 bg-gray-50 rounded-lg">
            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            </div>
            <div class="flex-1">
                <div class="flex items-center justify-between">
                    <p class="font-medium text-gray-900">Scheduled Maintenance</p>
                    <span class="status-badge active">Completed</span>
                </div>
                <p class="text-sm text-gray-500 mt-1">Database migration and index optimization</p>
                <p class="text-xs text-gray-400 mt-2">Jan 15, 2025 - Duration: 45 minutes</p>
            </div>
        </div>
    </div>
</div>
