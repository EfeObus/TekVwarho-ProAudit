<!-- Security Dashboard Section -->
<!-- Answers: Is the platform secure? Any threats detected? -->

<!-- Security Stats -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="metric-card highlight">
        <div class="flex items-start justify-between">
            <div>
                <p class="metric-label">Security Score</p>
                <p class="metric-value">{{ dashboard.security.score if dashboard.security else 'A+' }}</p>
            </div>
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
            </div>
        </div>
    </div>
    <div class="metric-card">
        <p class="metric-label">Failed Logins (24h)</p>
        <p class="metric-value text-amber-500">{{ dashboard.security.failed_logins if dashboard.security else 23 }}</p>
        <p class="text-sm text-gray-500 mt-2">0 blocked IPs</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">Active Sessions</p>
        <p class="metric-value">{{ dashboard.security.active_sessions if dashboard.security else 156 }}</p>
        <p class="text-sm text-gray-500 mt-2">Across all tenants</p>
    </div>
    <div class="metric-card">
        <p class="metric-label">2FA Adoption</p>
        <p class="metric-value text-ng-green">{{ dashboard.security.twofa_rate if dashboard.security else '78%' }}</p>
        <p class="text-sm text-gray-500 mt-2">Of all users</p>
    </div>
</div>

<!-- Security Alerts -->
<div class="mb-8">
    <div class="section-header mb-4">
        <h3 class="section-title">
            <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
            Security Alerts
        </h3>
        <span class="text-sm text-gray-500">Last 24 hours</span>
    </div>
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Critical/High Alerts -->
        <div class="data-grid">
            <div class="p-4 border-b border-gray-100 bg-red-50 rounded-t-xl">
                <h4 class="font-semibold text-red-800">Critical & High Priority</h4>
            </div>
            <div class="p-4 space-y-3">
                <div class="p-3 bg-amber-50 rounded-lg border-l-4 border-amber-500">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="font-medium text-gray-900">Multiple failed login attempts</p>
                            <p class="text-sm text-gray-500 mt-1">IP: 102.89.45.123 - 15 attempts in 5 minutes</p>
                            <p class="text-xs text-gray-400 mt-2">2 hours ago</p>
                        </div>
                        <button class="btn-secondary text-xs">Block IP</button>
                    </div>
                </div>
                <div class="p-3 bg-amber-50 rounded-lg border-l-4 border-amber-500">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="font-medium text-gray-900">Unusual API activity detected</p>
                            <p class="text-sm text-gray-500 mt-1">High volume of requests from single user</p>
                            <p class="text-xs text-gray-400 mt-2">5 hours ago</p>
                        </div>
                        <button class="btn-secondary text-xs">Review</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Info Alerts -->
        <div class="data-grid">
            <div class="p-4 border-b border-gray-100 bg-blue-50 rounded-t-xl">
                <h4 class="font-semibold text-blue-800">Informational</h4>
            </div>
            <div class="p-4 space-y-3">
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-blue-500">
                    <p class="font-medium text-gray-900">New device login</p>
                    <p class="text-sm text-gray-500 mt-1">admin@lagostraders.com logged in from new device</p>
                    <p class="text-xs text-gray-400 mt-2">30 minutes ago</p>
                </div>
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-blue-500">
                    <p class="font-medium text-gray-900">Password changed</p>
                    <p class="text-sm text-gray-500 mt-1">User john@efeobu.com updated password</p>
                    <p class="text-xs text-gray-400 mt-2">1 hour ago</p>
                </div>
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-blue-500">
                    <p class="font-medium text-gray-900">2FA enabled</p>
                    <p class="text-sm text-gray-500 mt-1">3 users enabled two-factor authentication</p>
                    <p class="text-xs text-gray-400 mt-2">3 hours ago</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Security Metrics -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <!-- Authentication Stats -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>
                Authentication (24h)
            </h3>
        </div>
        <div class="space-y-4">
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">Successful logins</span>
                <span class="font-semibold text-ng-green">342</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">Failed logins</span>
                <span class="font-semibold text-amber-500">23</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">Password resets</span>
                <span class="font-semibold">8</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">2FA challenges</span>
                <span class="font-semibold">156</span>
            </div>
        </div>
    </div>
    
    <!-- Session Stats -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                Active Sessions
            </h3>
        </div>
        <div class="space-y-4">
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">Web sessions</span>
                <span class="font-semibold">134</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">API sessions</span>
                <span class="font-semibold">22</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">Avg session duration</span>
                <span class="font-semibold">45 min</span>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-100">
                <button class="btn-secondary w-full text-sm">Revoke All Sessions</button>
            </div>
        </div>
    </div>
    
    <!-- Security Checklist -->
    <div class="metric-card">
        <div class="section-header">
            <h3 class="section-title">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                Security Checklist
            </h3>
        </div>
        <div class="space-y-3">
            {% for item in [
                ('SSL/TLS Enabled', True),
                ('Database Encrypted', True),
                ('Backup Encryption', True),
                ('Rate Limiting Active', True),
                ('CORS Configured', True),
                ('Security Headers', True),
                ('Audit Logging', True),
                ('Vulnerability Scan', True)
            ] %}
            <div class="flex items-center justify-between">
                <span class="text-sm">{{ item[0] }}</span>
                {% if item[1] %}
                <svg class="w-5 h-5 text-ng-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                {% else %}
                <svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- IP Blocklist -->
<div class="data-grid">
    <div class="p-4 border-b border-gray-100">
        <div class="flex items-center justify-between">
            <h3 class="font-semibold text-gray-900 flex items-center gap-2">
                <svg class="w-5 h-5 text-ng-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/></svg>
                IP Blocklist
            </h3>
            <button class="btn-primary text-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/></svg>
                Add IP
            </button>
        </div>
    </div>
    <table>
        <thead>
            <tr>
                <th>IP Address</th>
                <th>Reason</th>
                <th>Blocked Date</th>
                <th>Expires</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="font-mono">192.168.1.100</td>
                <td>Brute force attempt</td>
                <td class="text-sm text-gray-500">Jan 20, 2025</td>
                <td class="text-sm text-gray-500">Jan 27, 2025</td>
                <td>
                    <button class="btn-secondary text-xs">Unblock</button>
                </td>
            </tr>
            <tr>
                <td class="font-mono">10.0.0.45</td>
                <td>Suspicious activity</td>
                <td class="text-sm text-gray-500">Jan 18, 2025</td>
                <td class="text-sm text-gray-500">Permanent</td>
                <td>
                    <button class="btn-secondary text-xs">Unblock</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>
